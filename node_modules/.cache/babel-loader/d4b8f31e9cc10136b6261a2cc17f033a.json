{"ast":null,"code":"var _jsxFileName = \"C:\\\\xampp\\\\htdocs\\\\sns\\\\src\\\\Component\\\\CommentWriting\\\\CommentWriting.js\";\nimport * as React from 'react';\nimport \"./CommentWriting.css\";\nimport { MyEmotions } from \"../MyEmotions/MyEmotions\";\nimport { MyEmojis } from \"../MyEmojis/MyEmojis\";\nimport { addComment, updateComment } from \"../../services/DataService\";\n\nconst replaceAll = (str, target, replacement) => {\n  return str.split(target).join(replacement);\n};\n\nconst htmlchar_run = str => {\n  let tmp = replaceAll(str, '\\t', \"&nbsp;&nbsp;&nbsp;&nbsp;\");\n  tmp = replaceAll(tmp, \" \", \"&nbsp;\");\n  tmp = replaceAll(tmp, '\\n', \"<br/>\");\n  tmp = \"<div>\" + tmp + \"</div>\";\n  return tmp;\n};\n\nexport class CommentWriting extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.addCommentEvent = () => {\n      console.log(this.props.postid);\n      let data = {\n        postid: this.props.postid,\n        userid: JSON.parse(localStorage.getItem(\"userInfo\")).id,\n        contents: escape(htmlchar_run(this.state.postContents)),\n        emoticon: this.state.emoticon == null ? null : this.state.emoticon\n      };\n      addComment(data, res => {\n        console.log(res);\n\n        if (res.result === 1) {\n          this.props.onAddComment(res.data);\n          this.input.current.innerHTML = \"\";\n          this.setState({\n            postContents: this.input.current.innerHTML,\n            emoticon: null\n          });\n        }\n      });\n    };\n\n    this.editCommentEvent = () => {\n      let data = {\n        commentid: this.props.commentData.id,\n        contents: escape(htmlchar_run(this.state.postContents)),\n        emoticon: this.state.emoticon == null ? null : this.state.emoticon\n      };\n      updateComment(data, res => {\n        let comment = this.props.commentData;\n        Object.assign(comment, {\n          contents: data.contents,\n          emoticon: data.emoticon\n        });\n        this.props.onUpdateComment(comment.id, comment);\n        this.props.onShowEditForm();\n      });\n    };\n\n    this.onCommentBtnClick = () => {\n      if (this.props.type === \"edit\") {\n        this.editCommentEvent();\n      } else {\n        this.addCommentEvent();\n      }\n    };\n\n    this.showEmoji = () => this.state.isEmojiFade ? this.setState({\n      isEmojiFade: false\n    }) : this.setState({\n      isEmojiFade: true\n    });\n\n    this.showEmotion = () => this.state.isEmotionFade ? this.setState({\n      isEmotionFade: false\n    }) : this.setState({\n      isEmotionFade: true\n    });\n\n    this.writeEvent = e => {\n      if (this.state.isPostOn === false) this.setState({\n        isPostOn: true\n      });\n      this.setState({\n        postContents: e.target.innerHTML\n      });\n    };\n\n    this.addEmoji = e => {\n      this.input.current.innerHTML = this.input.current.innerHTML + e.target.innerHTML;\n      this.setState({\n        postContents: this.input.current.innerHTML\n      });\n    };\n\n    this.addEmotion = e => {\n      let imgsrc = String(e.target.src);\n      let imglink = imgsrc.substring(imgsrc.length, 21); // console.log();\n\n      this.setState({\n        emoticon: imglink\n      }); // console.log(this.state.postContents);\n    };\n\n    this.state = {\n      postContents: \"\",\n      emoticon: null,\n      isEmotionFade: false,\n      isEmojiFade: false\n    };\n    this.input = React.createRef();\n  }\n\n  componentDidMount() {\n    if (this.props.type === \"edit\") {\n      const commentData = this.props.commentData;\n      console.log(commentData);\n      this.input.current.innerHTML = unescape(commentData.contents);\n      this.setState({\n        postContents: this.input.current.innerHTML,\n        emoticon: commentData.emoticon !== \"\" ? commentData.emoticon : null\n      }); // this.props.commentData\n    }\n  }\n\n  render() {\n    const _this$state = this.state,\n          isEmotionFade = _this$state.isEmotionFade,\n          isEmojiFade = _this$state.isEmojiFade,\n          emoticon = _this$state.emoticon;\n    const _this$props = this.props,\n          postid = _this$props.postid,\n          data = _this$props.data,\n          onloadComments = _this$props.onloadComments,\n          type = _this$props.type;\n    return React.createElement(\"div\", {\n      className: \"relative\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: `inp_write_wrap ${type !== undefined && type === \"edit\" ? \"editCommentStyle\" : null}`,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      id: \"contents_write\",\n      className: \"inp_write\",\n      contentEditable: \"true\",\n      onChange: this.writeEvent,\n      onInput: this.writeEvent,\n      placeholder: \"\\uB313\\uAE00\\uC744 \\uC785\\uB825\\uD558\\uC138\\uC694.\",\n      ref: this.input,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117\n      },\n      __self: this\n    }), this.state.emoticon == null ? null : React.createElement(\"div\", {\n      className: \"relative\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      src: this.state.emoticon,\n      className: \"emoticonStyle\",\n      alt: \"emotion\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123\n      },\n      __self: this\n    }), React.createElement(\"p\", {\n      className: \"ico_ks bn_x6\",\n      onClick: () => this.setState({\n        emoticon: null\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"ico_ks bn_photo\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"bn_emoji\",\n      onClick: this.showEmoji,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129\n      },\n      __self: this\n    }, \"\\uD83D\\uDE42\"), React.createElement(\"div\", {\n      className: \"ico_ks2 bn_emoti\",\n      onClick: this.showEmotion,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130\n      },\n      __self: this\n    })), isEmotionFade ? React.createElement(MyEmotions, {\n      addEmotion: this.addEmotion,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133\n      },\n      __self: this\n    }) : null, isEmojiFade ? React.createElement(MyEmojis, {\n      addEmoji: this.addEmoji,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134\n      },\n      __self: this\n    }) : null, React.createElement(\"button\", {\n      className: \"btn orangeColorBtn nullTextOrangeColor\",\n      style: this.state.postContents.length > 0 ? {\n        display: \"none\"\n      } : type === \"edit\" ? {\n        position: \"absolute\",\n        top: \"0\",\n        right: \"-76px\"\n      } : {\n        display: \"inline-block\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135\n      },\n      __self: this\n    }, \"\\uC804\\uC1A1\"), React.createElement(\"button\", {\n      className: \"btn orangeColorBtn\",\n      onClick: this.onCommentBtnClick,\n      style: this.state.postContents.length > 0 ? type === \"edit\" ? {\n        position: \"absolute\",\n        top: \"0\",\n        right: \"-76px\"\n      } : {\n        display: \"inline-block\"\n      } : {\n        display: \"none\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140\n      },\n      __self: this\n    }, \"\\uC804\\uC1A1\"), type === \"edit\" ? React.createElement(\"button\", {\n      className: \"blackLineBtn\",\n      style: {\n        position: \"absolute\",\n        top: \"37px\",\n        right: \"-76px\"\n      },\n      onClick: this.props.onShowEditForm,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150\n      },\n      __self: this\n    }, \"\\uCDE8\\uC18C\") : null);\n  }\n\n}\n;","map":{"version":3,"sources":["C:/xampp/htdocs/sns/src/Component/CommentWriting/CommentWriting.js"],"names":["React","MyEmotions","MyEmojis","addComment","updateComment","replaceAll","str","target","replacement","split","join","htmlchar_run","tmp","CommentWriting","Component","constructor","props","addCommentEvent","console","log","postid","data","userid","JSON","parse","localStorage","getItem","id","contents","escape","state","postContents","emoticon","res","result","onAddComment","input","current","innerHTML","setState","editCommentEvent","commentid","commentData","comment","Object","assign","onUpdateComment","onShowEditForm","onCommentBtnClick","type","showEmoji","isEmojiFade","showEmotion","isEmotionFade","writeEvent","e","isPostOn","addEmoji","addEmotion","imgsrc","String","src","imglink","substring","length","createRef","componentDidMount","unescape","render","onloadComments","undefined","display","position","top","right"],"mappings":"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","sourcesContent":["import * as React from 'react';\r\nimport \"./CommentWriting.css\";\r\nimport {MyEmotions} from \"../MyEmotions/MyEmotions\";\r\nimport {MyEmojis} from \"../MyEmojis/MyEmojis\";\r\nimport {addComment, updateComment} from \"../../services/DataService\";\r\n\r\nconst replaceAll = (str, target, replacement) => {\r\n  return str.split(target).join(replacement);\r\n};\r\n\r\nconst htmlchar_run = (str) => {\r\n  let  tmp=replaceAll(str,'\\t',\"&nbsp;&nbsp;&nbsp;&nbsp;\");\r\n  tmp=replaceAll(tmp,\" \",\"&nbsp;\");\r\n  tmp=replaceAll(tmp,'\\n',\"<br/>\");\r\n  tmp= \"<div>\"+tmp+\"</div>\";\r\n  return tmp;\r\n\r\n};\r\n\r\n\r\nexport class CommentWriting extends React.Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      postContents: \"\",\r\n      emoticon: null,\r\n      isEmotionFade: false,\r\n      isEmojiFade: false,\r\n    };\r\n\r\n    this.input = React.createRef();\r\n  }\r\n\r\n\r\n  addCommentEvent = () => {\r\n    console.log(this.props.postid);\r\n    let data = {\r\n      postid: this.props.postid,\r\n      userid: JSON.parse(localStorage.getItem(\"userInfo\")).id,\r\n      contents: escape(htmlchar_run(this.state.postContents)),\r\n      emoticon: (this.state.emoticon == null) ? null : this.state.emoticon,\r\n    };\r\n\r\n    addComment(data, (res) => {\r\n      console.log(res);\r\n      if(res.result === 1) {\r\n        this.props.onAddComment(res.data);\r\n        this.input.current.innerHTML = \"\";\r\n        this.setState({postContents: this.input.current.innerHTML, emoticon: null});\r\n      }\r\n    });\r\n  };\r\n\r\n  editCommentEvent = () => {\r\n    let data = {\r\n      commentid: this.props.commentData.id,\r\n      contents: escape(htmlchar_run(this.state.postContents)),\r\n      emoticon: (this.state.emoticon == null) ? null : this.state.emoticon,\r\n    };\r\n\r\n    updateComment(data, (res) => {\r\n      let comment = this.props.commentData;\r\n      Object.assign(comment, {contents: data.contents, emoticon: data.emoticon});\r\n      this.props.onUpdateComment(comment.id, comment);\r\n      this.props.onShowEditForm();\r\n    });\r\n  };\r\n\r\n  onCommentBtnClick = () => {\r\n    if(this.props.type === \"edit\") {\r\n      this.editCommentEvent();\r\n    } else {\r\n      this.addCommentEvent();\r\n    }\r\n  };\r\n\r\n  componentDidMount() {\r\n    if(this.props.type === \"edit\") {\r\n      const {commentData} = this.props;\r\n      console.log(commentData);\r\n\r\n      this.input.current.innerHTML =  unescape(commentData.contents);\r\n      this.setState({postContents: this.input.current.innerHTML,\r\n        emoticon: (commentData.emoticon !== \"\") ? commentData.emoticon : null});\r\n      // this.props.commentData\r\n    }\r\n  }\r\n\r\n  showEmoji = () => (this.state.isEmojiFade) ? this.setState({isEmojiFade: false}) : this.setState({isEmojiFade: true});\r\n  showEmotion = () => (this.state.isEmotionFade) ? this.setState({isEmotionFade: false}) : this.setState({isEmotionFade: true});\r\n\r\n  writeEvent = (e) => {\r\n    if (this.state.isPostOn === false) this.setState({isPostOn: true});\r\n    this.setState({postContents: e.target.innerHTML});\r\n  };\r\n\r\n  addEmoji = (e) => {\r\n    this.input.current.innerHTML =  this.input.current.innerHTML + e.target.innerHTML;\r\n    this.setState({postContents: this.input.current.innerHTML});\r\n  };\r\n\r\n  addEmotion = (e) => {\r\n    let imgsrc = String(e.target.src);\r\n    let imglink = imgsrc.substring(imgsrc.length, 21);\r\n    // console.log();\r\n    this.setState({emoticon: imglink});\r\n    // console.log(this.state.postContents);\r\n  };\r\n\r\n  render() {\r\n    const {isEmotionFade, isEmojiFade, emoticon} = this.state;\r\n    const {postid, data, onloadComments, type} = this.props;\r\n    return (\r\n      <div className=\"relative\">\r\n        <div className={`inp_write_wrap ${(type !== undefined && type === \"edit\") ? \"editCommentStyle\" : null}`}>\r\n          <div id=\"contents_write\" className=\"inp_write\" contentEditable=\"true\"\r\n               onChange={this.writeEvent} onInput={this.writeEvent}\r\n               placeholder=\"댓글을 입력하세요.\" ref={this.input} />\r\n          {\r\n            (this.state.emoticon == null) ? null :\r\n              (<div className=\"relative\">\r\n                <img src={this.state.emoticon} className=\"emoticonStyle\" alt=\"emotion\"/>\r\n                <p className=\"ico_ks bn_x6\" onClick={() => this.setState({emoticon: null})}/>\r\n              </div>)\r\n          }\r\n\r\n          <div className=\"ico_ks bn_photo\"/>\r\n          <div className=\"bn_emoji\" onClick={this.showEmoji}>🙂</div>\r\n          <div className=\"ico_ks2 bn_emoti\" onClick={this.showEmotion}/>\r\n\r\n        </div>\r\n        {(isEmotionFade) ? <MyEmotions addEmotion={this.addEmotion}/> : null}\r\n        {(isEmojiFade) ? <MyEmojis addEmoji={this.addEmoji}/> : null}\r\n        <button className=\"btn orangeColorBtn nullTextOrangeColor\"\r\n                style={(this.state.postContents.length > 0) ?\r\n                  {display: \"none\"} :  (type === \"edit\") ?\r\n                    {position: \"absolute\", top: \"0\", right: \"-76px\"} : {display: \"inline-block\"} }>전송\r\n        </button>\r\n        <button className=\"btn orangeColorBtn\"\r\n                onClick={this.onCommentBtnClick}\r\n                style={(this.state.postContents.length > 0) ?\r\n                  (type === \"edit\") ?\r\n                    {position: \"absolute\", top: \"0\", right: \"-76px\"} :\r\n                    {display: \"inline-block\"} :\r\n                  {display: \"none\"}}>전송\r\n        </button>\r\n        {\r\n          (type === \"edit\") ?\r\n            (<button className=\"blackLineBtn\" style={{position: \"absolute\", top: \"37px\",\r\n              right: \"-76px\"}} onClick={this.props.onShowEditForm}>취소</button>) : null\r\n        }\r\n      </div>\r\n    );\r\n  };\r\n};"]},"metadata":{},"sourceType":"module"}